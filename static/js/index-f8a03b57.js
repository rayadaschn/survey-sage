function e(){import.meta.url,import("_").catch((()=>1))}import{r as s,ad as t,ae as r,M as a,af as n,ag as i,ah as l,ab as c,ai as o,ac as d,aj as x,ak as h,R as j}from"./@ant-design/icons-70aec636.js";import{r as m,S as u,T as p,L as f,m as g,B as v,D as y,F as N,I as b,R as w,a as k,P as S,M as C,b as I,E as _,c as q,C as P,t as O}from"./antd-fa492b82.js";import{L as T,O as R,u as E,a as z,b as F,c as L,d as D,R as A}from"./react-router-dom-5ed4d8f0.js";import{a as M}from"./axios-83bdef92.js";import{u as B,a as U}from"./ahooks-e08d8f5e.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var W={exports:{}},$={},K=s,H=Symbol.for("react.element"),J=Symbol.for("react.fragment"),Q=Object.prototype.hasOwnProperty,V=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y={key:!0,ref:!0,__self:!0,__source:!0};function G(e,s,t){var r,a={},n=null,i=null;for(r in void 0!==t&&(n=""+t),void 0!==s.key&&(n=""+s.key),void 0!==s.ref&&(i=s.ref),s)Q.call(s,r)&&!Y.hasOwnProperty(r)&&(a[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===a[r]&&(a[r]=s[r]);return{$$typeof:H,type:e,key:n,ref:i,props:a,_owner:V.current}}$.Fragment=J,$.jsx=G,$.jsxs=G,W.exports=$;var X=W.exports;var Z={},ee=m;Z.createRoot=ee.createRoot,Z.hydrateRoot=ee.hydrateRoot;const{Title:se}=p,te=()=>X.jsx("div",{children:X.jsx(T,{to:"/",children:X.jsxs(u,{children:[X.jsx(se,{children:X.jsx(t,{})}),X.jsx(se,{children:"问卷调查"})]})})}),re=()=>X.jsx(X.Fragment,{children:X.jsx(T,{to:Le,children:"登录"})}),{Header:ae,Content:ne,Footer:ie}=f,le=()=>X.jsxs(f,{children:[X.jsxs(ae,{className:"px-6",children:[X.jsx("div",{className:"float-left",children:X.jsx(te,{})}),"MainLayout header",X.jsx("div",{className:"float-right",children:X.jsx(re,{})})]}),X.jsx(ne,{className:"min-h-[calc(100vh-140px)]",children:X.jsx(R,{})}),X.jsx(ie,{className:"border-t border-gray-200 border-solid bg-white text-center",children:"文件调查@2023 Created by Huy"})]});const ce="keyword",oe=M.create({timeout:1e4,baseURL:"http://198.18.1.185:3001/"});async function de(){return await oe.post("/api/question/")}oe.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("USER_TOKEN")||""),e)),(e=>(g.error(e.message),Promise.reject(e)))),oe.interceptors.response.use((e=>{const s=e.data||{},{errno:t,data:r,msg:a}=s;return 203===t||200!==t?(g.error(a||"请求失败"),Promise.reject(r)):r}),(e=>{var s;let t="";switch(null==(s=e.response)?void 0:s.status){case 401:t="token 失效，请重新登录";break;case 403:t="拒绝访问";break;case 404:t="请求地址错误";break;case 500:t="服务器故障";break;default:t="网络连接故障"}return g.error(t),Promise.reject(e)}));const xe=()=>{const e=E(),{pathname:s}=z(),{loading:t,run:l}=B(de,{manual:!0,onSuccess(s){e("question/edit/".concat(s.id)),g.success("创建成功")}});return X.jsxs("div",{className:"py-6",children:[X.jsx("div",{className:"w-30",children:X.jsxs(u,{direction:"vertical",children:[X.jsx(v,{type:"primary",size:"large",icon:X.jsx(r,{}),onClick:l,disabled:t,children:"新建问卷"}),X.jsx(y,{}),X.jsx(v,{type:s.startsWith("/manage/list")?"default":"text",size:"large",icon:X.jsx(a,{}),onClick:()=>e("/manage/list"),children:"我的问卷"}),X.jsx(v,{type:s.startsWith("/manage/star")?"default":"text",size:"large",icon:X.jsx(n,{}),onClick:()=>e("/manage/star"),children:"星标问卷"}),X.jsx(v,{type:s.startsWith("/manage/trash")?"default":"text",size:"large",icon:X.jsx(i,{}),onClick:()=>e("/manage/trash"),children:"回收站"})]})}),X.jsx("div",{className:"ml-15 flex-1",children:X.jsx(R,{})})]})},he=()=>X.jsxs(X.Fragment,{children:[X.jsx("p",{children:"Question layout"}),X.jsx("div",{children:X.jsx(R,{})})]}),{Title:je}=p,me=()=>X.jsxs("div",{className:"flex flex-col items-center justify-center bg-white",children:[X.jsx("div",{children:X.jsxs(u,{children:[X.jsx(je,{level:2,children:X.jsx(l,{})}),X.jsx(je,{level:2,children:"注册新用户"})]})}),X.jsx("div",{children:X.jsxs(N,{labelCol:{span:6},wrapperCol:{span:16},onFinish:e=>{},children:[X.jsx(N.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{type:"string",min:5,max:20,message:"字符长度在 5-20 之间"},{pattern:/^\w+$/,message:"只能所字符下划线"}],children:X.jsx(b,{})}),X.jsx(N.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:X.jsx(b.Password,{})}),X.jsx(N.Item,{label:"确认密码",name:" confirm",rules:[{required:!0,message:"请输入密码"},({getFieldValue:e})=>({validator:(s,t)=>t&&e("password")!==t?Promise.reject(new Error("两次密码不一致")):Promise.resolve()})],children:X.jsx(b.Password,{})}),X.jsx(N.Item,{label:"昵称",name:"nickname",children:X.jsx(b,{})}),X.jsx(N.Item,{wrapperCol:{offset:4,span:18},children:X.jsxs(u,{children:[X.jsx(v,{type:"primary",htmlType:"submit",children:"注册"}),X.jsx(T,{to:Le,children:"已有账户，请登录"})]})})]})})]}),ue=()=>{const e=E();return X.jsx(X.Fragment,{children:X.jsx(w,{status:"404",title:"404",subTitle:"抱歉，您访问的页面不存在",extra:X.jsx(v,{type:"primary",onClick:()=>e(De),children:"返回首页"})})})},{confirm:pe}=C,fe=e=>{const{id:s,title:t,isPublished:r,answerContent:a,currentAt:l,isStar:h}=e,j=E();return X.jsxs("div",{className:"mb-2.5 border-rounded bg-white p-3 transition-transform hover:scale-105 hover:transform hover:shadow-md",children:[X.jsxs("div",{className:"flex",children:[X.jsx("div",{className:"flex-1",children:X.jsx(T,{to:r?"/question/stat/".concat(s):"/question/edit/".concat(s),children:X.jsxs(u,{children:[h&&X.jsx(n,{style:{color:"red"}}),t]})})}),X.jsx("div",{className:"flex-1 text-center font-size-3",children:X.jsxs(u,{children:[r?X.jsx(k,{color:"processing",children:"已发布"}):X.jsx(k,{children:"未发布"}),X.jsxs("span",{children:["答卷: ",a]}),X.jsx("span",{children:l})]})})]}),X.jsx(y,{className:"m-3"}),X.jsxs("div",{className:"flex",children:[X.jsx("div",{className:"flex-1",children:X.jsxs(u,{children:[X.jsx(v,{icon:X.jsx(c,{}),type:"text",size:"small",onClick:()=>{j("/question/edit/".concat(s))},children:"编辑问卷"}),X.jsx(v,{icon:X.jsx(o,{}),type:"text",size:"small",onClick:()=>{j("/question/stat/".concat(s))},children:"数据统计"})]})}),X.jsx("div",{className:"flex-1 text-center",children:X.jsxs(u,{children:[X.jsx(v,{type:"text",icon:X.jsx(n,{}),color:"#999",size:"small",children:"标星"}),X.jsx(S,{title:"确定复制该问卷?",okText:"确认",cancelText:"取消",onConfirm:()=>{},children:X.jsx(v,{type:"text",icon:X.jsx(d,{}),color:"#999",size:"small",children:"复制"})}),X.jsx(v,{type:"text",icon:X.jsx(i,{}),size:"small",color:"#999",onClick:()=>{pe({title:"确定删除该问卷?",icon:X.jsx(x,{}),onOk:()=>g.success("删除")})},children:"删除"})]})})]})]})},{Search:ge}=b,ve=()=>{const e=E(),{pathname:t}=z(),[r,a]=s.useState("");const[n]=F();return s.useEffect((()=>{const e=n.get(ce)||"";a(e)}),[n]),X.jsx(ge,{placeholder:"请输入关键字",value:r,onChange:function(e){a(e.target.value)},onSearch:function(s){e({pathname:t,search:"".concat(ce,"=").concat(s)})},className:"w-50"})};function ye(){const{id:e=""}=L(),[t,r]=s.useState(!0),[a,n]=s.useState({});return s.useEffect((()=>{!async function(){const s=await async function(e){const s="/api/question/".concat(e);return await oe.get(s)}(e);n(s),r(!1)}()}),[e]),{loading:t,questionData:a}}function Ne(e={}){const{isStar:s,isDeleted:t}=e,[r]=F(),{data:a,loading:n,error:i}=B((async()=>{const e=r.get(ce)||"",a=parseInt(r.get("page")||"")||1,n=parseInt(r.get("pageSize")||"")||10,i=await async function(e={}){return await oe.get("/api/question",{params:e})}({keyword:e,isStar:s,isDeleted:t,page:a,pageSize:n});return i}));return{data:a,loading:n,error:i}}const{Title:be}=p,we=()=>{const{data:e={},loading:s}=Ne(),{list:t=[],total:r=0}=e;return X.jsxs(X.Fragment,{children:[X.jsxs("div",{className:"flex",children:[X.jsx("div",{className:"flex-1",children:X.jsx(be,{level:3,children:"我的问卷"})}),X.jsx("div",{className:"flex-1 text-center",children:X.jsx(ve,{})})]}),X.jsxs("div",{className:"mb-5",children:[s&&X.jsx("div",{className:"text-center",children:X.jsx(I,{})}),t.length>0&&t.map((e=>{const{_id:s}=e;return X.jsx(fe,{...e},s)}))]}),X.jsx("div",{className:"color-blue",children:"footer"})]})},{Title:ke}=p,{confirm:Se}=C,Ce=()=>{U("问卷调查");const{data:e={},loading:t}=Ne({isStar:!0}),{list:r=[],total:a=0}=e,[n,i]=s.useState([]),l=[{title:"标题",dataIndex:"title"},{title:"是否发布",dataIndex:"isPublished",render:e=>e?X.jsx(k,{color:"processing",children:"已发布"}):X.jsx(k,{children:"未发布"})},{title:"答卷",dataIndex:"answerCount"},{title:"创建时间",dataIndex:"createdAt"}];return X.jsxs(X.Fragment,{children:[X.jsxs("div",{className:"flex",children:[X.jsx("div",{className:"flex-1",children:X.jsx(ke,{level:3,children:"回收站"})}),X.jsx("div",{className:"flex-1 text-center",children:X.jsx(ve,{})})]}),X.jsxs("div",{className:"mb-5",children:[t&&X.jsx("div",{className:"text-center",children:X.jsx(I,{})}),!t&&0===r.length&&X.jsx(_,{description:"暂无数据"}),r.length>0&&X.jsxs("div",{children:[X.jsxs(u,{className:"mb",children:[X.jsx(v,{type:"primary",disabled:0===n.length,children:"恢复"}),X.jsx(v,{danger:!0,disabled:0===n.length,onClick:()=>{Se({title:"确定彻底删除该问卷?",icon:X.jsx(h,{}),content:"删除以后不可撤回",onOk:()=>alert("删除")})},children:"彻底删除"})]}),X.jsx(q,{rowKey:e=>e._id,dataSource:r,columns:l,pagination:!1,rowSelection:{type:"checkbox",onChange:e=>{i(e)}}})]})]})]})},{Title:Ie}=p,_e=()=>{const{data:e={},loading:s}=Ne({isStar:!0}),{list:t=[],total:r=0}=e;return X.jsxs(X.Fragment,{children:[X.jsxs("div",{className:"flex",children:[X.jsx("div",{className:"flex-1",children:X.jsx(Ie,{level:3,children:"星标问卷"})}),X.jsx("div",{className:"flex-1 text-center",children:X.jsx(ve,{})})]}),X.jsxs("div",{className:"mb-5",children:[s&&X.jsx("div",{className:"text-center",children:X.jsx(I,{})}),!s&&0===t.length&&X.jsx(_,{description:"暂无数据"}),t.length>0&&t.map((e=>{const{_id:s}=e;return X.jsx(fe,{...e},s)}))]}),X.jsx("div",{className:"color-blue",children:"分页"})]})},qe=()=>{const{loading:e,questionData:s}=ye();return X.jsxs("div",{children:[X.jsx("p",{children:"编辑"}),e?X.jsx("p",{children:"loading"}):X.jsx("p",{children:JSON.stringify(s)})]})},Pe=()=>{const{loading:e,questionData:s}=ye();return X.jsxs("div",{children:[X.jsx("p",{children:"Stat"}),e?X.jsx("p",{children:"loading"}):X.jsx("p",{children:JSON.stringify(s)})]})},{Title:Oe,Paragraph:Te}=p,Re=()=>{const e=E();return X.jsx("div",{className:"h-150 flex flex-col items-center justify-center",children:X.jsxs("div",{className:"text-center",children:[X.jsx(Oe,{children:"问卷调查 | 在线投票"}),X.jsx(Te,{children:"已经累计创建问卷 500 份，发布问卷 80 份，收到答卷 2000 份"}),X.jsx("div",{className:"h-15 font-24",children:X.jsx(v,{className:"b-rounded-4",type:"primary",onClick:()=>e(De),children:"开始使用"})})]})})},{Title:Ee}=p,ze=()=>X.jsxs("div",{className:"flex flex-col items-center justify-center bg-white",children:[X.jsx("div",{children:X.jsxs(u,{children:[X.jsx(Ee,{level:2,children:X.jsx(l,{})}),X.jsx(Ee,{level:2,children:"登录"})]})}),X.jsx("div",{children:X.jsxs(N,{labelCol:{span:6},wrapperCol:{span:16},onFinish:e=>{},children:[X.jsx(N.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{type:"string",min:5,max:20,message:"字符长度在 5-20 之间"},{pattern:/^\w+$/,message:"只能所字符下划线"}],children:X.jsx(b,{})}),X.jsx(N.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:X.jsx(b.Password,{})}),X.jsx(N.Item,{wrapperCol:{offset:4,span:18},children:X.jsxs(u,{children:[X.jsx(v,{type:"primary",htmlType:"submit",children:"登录"}),X.jsx(T,{to:"/",children:"注册新用户"})]})})]})})]}),Fe=D([{path:"/",element:X.jsx(le,{}),children:[{path:"/",element:X.jsx(Re,{})},{path:"login",element:X.jsx(ze,{})},{path:"register",element:X.jsx(me,{})},{path:"manage",element:X.jsx(xe,{}),children:[{path:"list",element:X.jsx(we,{})},{path:"star",element:X.jsx(_e,{})},{path:"trash",element:X.jsx(Ce,{})}]},{path:"*",element:X.jsx(ue,{})}]},{path:"question",element:X.jsx(he,{}),children:[{path:"edit/:id",element:X.jsx(qe,{})},{path:"stat/:id",element:X.jsx(Pe,{})}]}],{basename:"/survey-sage"}),Le="/login",De="/manage/list",Ae=()=>X.jsx(P,{theme:{algorithm:O.defaultAlgorithm},children:X.jsx(A,{router:Fe})});Z.createRoot(document.getElementById("root")).render(X.jsx(j.StrictMode,{children:X.jsx(Ae,{})}));export{e as __vite_legacy_guard};
