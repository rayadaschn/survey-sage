System.register(["./@ant-design/icons-legacy-e6438a93.js","./antd-legacy-14e8005f.js","./react-router-dom-legacy-059048b1.js","./axios-legacy-787fab56.js","./ahooks-legacy-17b2144d.js"],(function(e,s){"use strict";var t,r,n,a,i,l,c,o,d,x,h,m,u,j,p,g,f,y,b,v,w,S,N,k,C,I,_,E,q,R,P,F,T,z,O,$,D,L,A,U,M,B,W,H,J,K;return{setters:[e=>{t=e.r,r=e.ad,n=e.ae,a=e.af,i=e.M,l=e.ag,c=e.ah,o=e.ai,d=e.ab,x=e.aj,h=e.ac,m=e.ak,u=e.al,j=e.R},e=>{p=e.r,g=e.S,f=e.T,y=e.m,b=e.B,v=e.L,w=e.D,S=e.F,N=e.I,k=e.R,C=e.a,I=e.P,_=e.M,E=e.b,q=e.E,R=e.c,P=e.d,F=e.C,T=e.e,z=e.t},e=>{O=e.L,$=e.u,D=e.O,L=e.a,A=e.b,U=e.c,M=e.d,B=e.R},e=>{W=e.a},e=>{H=e.u,J=e.a,K=e.b}],execute:function(){var e=document.createElement("style");e.textContent='#--unocss--{layer:__ALL__}:root{--w-space-xs: 8px;--w-space-sm: 16px;--w-space: 24px;--w-space-lg: 32px;--w-radius-xs: 4px;--w-radius: 8px;--w-radius-lg: 12px;--w-radius-xl: 16px;--c-white: #fff;--c-black: #000;--c-blue: #3b82f6;--c-red: #ef4444;--c-yellow: #f59e0b;--c-green: #42b983;--c-gray: #9ca3af;--c-disable: rgba(0, 0, 0, .25);--c-brand: var(--c-green);--c-bg: #f8f8f8;--c-text: #374151;--c-tips: var(--c-gray);--c-border: var(--c-gray);--c-mask: rgba(0, 0, 0, .7);--c-hover: var(--c-brand)}:root.dark{--c-bg: #181818;--c-text: #e5e7eb}html{width:100%;overflow-x:hidden}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:"tnum";font-variant:tabular-nums;background-color:var(--c-bg);margin:0}::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-thumb{background-color:#374151;border-radius:4px}::-webkit-scrollbar-thumb:hover{background-color:#1f2937}::-webkit-scrollbar-track{background-color:#6b7280;border-radius:4px}._container_1fxih_1 h1{font-size:28px;color:#f7f7f7}\n',document.head.appendChild(e);var s={exports:{}},V={},Q=t,Y=Symbol.for("react.element"),G=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,Z=Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ee={key:!0,ref:!0,__self:!0,__source:!0};function se(e,s,t){var r,n={},a=null,i=null;for(r in void 0!==t&&(a=""+t),void 0!==s.key&&(a=""+s.key),void 0!==s.ref&&(i=s.ref),s)X.call(s,r)&&!ee.hasOwnProperty(r)&&(n[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===n[r]&&(n[r]=s[r]);return{$$typeof:Y,type:e,key:a,ref:i,props:n,_owner:Z.current}}V.Fragment=G,V.jsx=se,V.jsxs=se,s.exports=V;var te=s.exports,re={},ne=p;re.createRoot=ne.createRoot,re.hydrateRoot=ne.hydrateRoot;const ae="_container_1fxih_1",{Title:ie}=f,le=()=>te.jsx("div",{children:te.jsx(O,{to:"/",children:te.jsxs(g,{className:ae,children:[te.jsx(ie,{children:te.jsx(r,{})}),te.jsx(ie,{children:"问卷调查"})]})})}),ce="USER_TOKEN",oe="keyword",de="page",xe="pageSize",he=W.create({timeout:1e4,baseURL:"https://huy.wiki:3002/"});async function me(){return await he.get("/api/user/info")}he.interceptors.request.use((e=>(e.headers.Authorization=`Bearer ${localStorage.getItem(ce)||""}`,e)),(e=>(y.error(e.message),Promise.reject(e)))),he.interceptors.response.use((e=>{const s=e.data||{},{errno:t,data:r,msg:n}=s;return 203===t||0!==t&&200!==t?(y.error(n||"请求失败"),Promise.reject(r)):r}),(e=>{let s="";const t=e.response?.status;switch(t){case 401:s="token 失效，请重新登录";break;case 403:s="拒绝访问";break;case 404:s="请求地址错误";break;case 500:s="服务器故障";break;default:s="网络连接故障"}return y.error(s),Promise.reject(e)}));const ue=()=>{const e=$(),{data:s}=H(me),{username:t,nickname:r}=s||{},a=te.jsxs(te.Fragment,{children:[te.jsxs("span",{className:"color-light",children:[te.jsx(n,{}),r]}),te.jsx(b,{type:"link",onClick:function(){localStorage.removeItem(ce),y.success("退出成功"),e(Ge)},children:"退出"})]}),i=te.jsx(O,{to:Ge,children:"登录"});return te.jsx(te.Fragment,{children:t?a:i})},{Header:je,Content:pe,Footer:ge}=v,fe=()=>te.jsxs(v,{children:[te.jsxs(je,{className:"px-6",children:[te.jsx("div",{className:"float-left",children:te.jsx(le,{})}),"MainLayout header",te.jsx("div",{className:"float-right",children:te.jsx(ue,{})})]}),te.jsx(pe,{className:"min-h-[calc(100vh-140px)]",children:te.jsx(D,{})}),te.jsx(ge,{className:"border-t border-gray-200 border-solid bg-white text-center",children:"文件调查@2023 Created by Huy"})]});async function ye(){return await he.post("/api/question/")}async function be(e={}){return await he.get("/api/question",{params:e})}async function ve(e,s){const t=`/api/question/${e}`;return await he.patch(t,s)}const we=()=>{const e=$(),{pathname:s}=L(),{loading:t,run:r}=H(ye,{manual:!0,onSuccess(s){e(`question/edit/${s.id}`),y.success("创建成功")}});return te.jsxs("div",{className:"mx-auto my-0 w-300 flex py-6",children:[te.jsx("div",{className:"w-30",children:te.jsxs(g,{direction:"vertical",children:[te.jsx(b,{type:"primary",size:"large",icon:te.jsx(a,{}),onClick:r,disabled:t,children:"新建问卷"}),te.jsx(w,{}),te.jsx(b,{type:s.startsWith("/manage/list")?"default":"text",size:"large",icon:te.jsx(i,{}),onClick:()=>e("/manage/list"),children:"我的问卷"}),te.jsx(b,{type:s.startsWith("/manage/star")?"default":"text",size:"large",icon:te.jsx(l,{}),onClick:()=>e("/manage/star"),children:"星标问卷"}),te.jsx(b,{type:s.startsWith("/manage/trash")?"default":"text",size:"large",icon:te.jsx(c,{}),onClick:()=>e("/manage/trash"),children:"回收站"})]})}),te.jsx("div",{className:"ml-15 flex-1",children:te.jsx(D,{})})]})},Se=()=>te.jsxs(te.Fragment,{children:[te.jsx("p",{children:"Question layout"}),te.jsx("div",{children:te.jsx(D,{})})]}),{Title:Ne}=f,ke=()=>{const e=$(),{run:s}=H((async e=>{const{username:s,password:t,nickname:r}=e;await async function(e,s,t){const r={username:e,password:s,nickname:t||e};return await he.post("/api/user/register",r)}(s,t,r)}),{manual:!0,onSuccess(){y.success("注册成功"),e(Ge)}});return te.jsxs("div",{className:"flex flex-col items-center justify-center bg-white",children:[te.jsx("div",{children:te.jsxs(g,{children:[te.jsx(Ne,{level:2,children:te.jsx(o,{})}),te.jsx(Ne,{level:2,children:"注册新用户"})]})}),te.jsx("div",{children:te.jsxs(S,{labelCol:{span:6},wrapperCol:{span:16},onFinish:e=>{s(e)},children:[te.jsx(S.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{type:"string",min:5,max:20,message:"字符长度在 5-20 之间"},{pattern:/^\w+$/,message:"只能所字符下划线"}],children:te.jsx(N,{})}),te.jsx(S.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:te.jsx(N.Password,{})}),te.jsx(S.Item,{label:"确认密码",name:" confirm",rules:[{required:!0,message:"请输入密码"},({getFieldValue:e})=>({validator:(s,t)=>t&&e("password")!==t?Promise.reject(new Error("两次密码不一致")):Promise.resolve()})],children:te.jsx(N.Password,{})}),te.jsx(S.Item,{label:"昵称",name:"nickname",children:te.jsx(N,{})}),te.jsx(S.Item,{wrapperCol:{offset:4,span:18},children:te.jsxs(g,{children:[te.jsx(b,{type:"primary",htmlType:"submit",children:"注册"}),te.jsx(O,{to:Ge,children:"已有账户，请登录"})]})})]})})]})},Ce=()=>{const e=$();return te.jsx(te.Fragment,{children:te.jsx(k,{status:"404",title:"404",subTitle:"抱歉，您访问的页面不存在",extra:te.jsx(b,{type:"primary",onClick:()=>e(Ze),children:"返回首页"})})})},{confirm:Ie}=_,_e=e=>{const{id:s,title:t,isPublished:r,answerContent:n,currentAt:a,isStar:i}=e,o=$();return te.jsxs("div",{className:"mb-2.5 border-rounded bg-white p-3 transition-transform hover:scale-105 hover:transform hover:shadow-md",children:[te.jsxs("div",{className:"flex",children:[te.jsx("div",{className:"flex-1",children:te.jsx(O,{to:r?`/question/stat/${s}`:`/question/edit/${s}`,children:te.jsxs(g,{children:[i&&te.jsx(l,{style:{color:"red"}}),t]})})}),te.jsx("div",{className:"flex-1 text-center font-size-3",children:te.jsxs(g,{children:[r?te.jsx(C,{color:"processing",children:"已发布"}):te.jsx(C,{children:"未发布"}),te.jsxs("span",{children:["答卷: ",n]}),te.jsx("span",{children:a})]})})]}),te.jsx(w,{className:"m-3"}),te.jsxs("div",{className:"flex",children:[te.jsx("div",{className:"flex-1",children:te.jsxs(g,{children:[te.jsx(b,{icon:te.jsx(d,{}),type:"text",size:"small",onClick:()=>{o(`/question/edit/${s}`)},children:"编辑问卷"}),te.jsx(b,{icon:te.jsx(x,{}),type:"text",size:"small",onClick:()=>{o(`/question/stat/${s}`)},children:"数据统计"})]})}),te.jsx("div",{className:"flex-1 text-center",children:te.jsxs(g,{children:[te.jsx(b,{type:"text",icon:te.jsx(l,{}),color:"#999",size:"small",children:"标星"}),te.jsx(I,{title:"确定复制该问卷?",okText:"确认",cancelText:"取消",onConfirm:()=>{},children:te.jsx(b,{type:"text",icon:te.jsx(h,{}),color:"#999",size:"small",children:"复制"})}),te.jsx(b,{type:"text",icon:te.jsx(c,{}),size:"small",color:"#999",onClick:()=>{Ie({title:"确定删除该问卷?",icon:te.jsx(m,{}),onOk:()=>y.success("删除")})},children:"删除"})]})})]})]})},{Search:Ee}=N,qe=()=>{const e=$(),{pathname:s}=L(),[r,n]=t.useState(""),[a]=A();return t.useEffect((()=>{const e=a.get(oe)||"";n(e)}),[a]),te.jsx(Ee,{placeholder:"请输入关键字",value:r,onChange:function(e){n(e.target.value)},onSearch:function(t){e({pathname:s,search:`${oe}=${t}`})},className:"w-50"})},{Title:Re}=f,Pe=()=>{const[e,s]=t.useState(!1),[r,n]=t.useState(1),[a,i]=t.useState([]),[l,c]=t.useState(0),o=l>a.length,[d]=A(),x=d.get(oe)||"";t.useEffect((()=>{s(!1),n(1),i([]),c(0)}),[x]);const{run:h,loading:m}=H((async()=>await be({page:r,pageSize:10,keyword:x})),{manual:!0,onSuccess(e){const{list:s=[],total:t=0}=e;i(a.concat(s)),c(t),n(r+1)}}),u=t.useRef(null),{run:j}=J((()=>{const e=u.current;if(null==e)return;const t=e.getBoundingClientRect();if(null==t)return;const{bottom:r}=t;r<=document.body.clientHeight&&(h(),s(!0))}),{wait:1e3});t.useEffect((()=>{j()}),[d]),t.useEffect((()=>(o&&window.addEventListener("scroll",j),()=>{window.removeEventListener("scroll",j)})),[d,o]);const p=t.useMemo((()=>!e||m?te.jsx(E,{}):0===l?te.jsx(q,{description:"暂无数据"}):o?te.jsx("span",{children:"开始加载下一页"}):te.jsx("span",{children:"没有更多了..."})),[e,m,o]);return te.jsxs(te.Fragment,{children:[te.jsxs("div",{className:"flex",children:[te.jsx("div",{className:"flex-1",children:te.jsx(Re,{level:3,children:"我的问卷"})}),te.jsx("div",{className:"flex-1 text-center",children:te.jsx(qe,{})})]}),te.jsx("div",{className:"mb-5",children:a.length>0&&a.map((e=>{const{_id:s}=e;return te.jsx(_e,{...e},s)}))}),te.jsx("div",{className:"text-center color-blue",children:te.jsx("div",{ref:u,children:p})})]})},Fe=e=>{const{total:s}=e,[r,n]=t.useState(1),[a,i]=t.useState(10),[l]=A();t.useEffect((()=>{const e=parseInt(l.get(de)||"")||1;n(e);const s=parseInt(l.get(xe)||"")||10;i(s)}),[l]);const c=$(),{pathname:o}=L();return te.jsx(R,{current:r,pageSize:a,total:s,onChange:(e,s)=>{l.set(de,e.toString()),l.set(xe,s.toString()),c({pathname:o,search:l.toString()})}})};function Te(){const{id:e=""}=U(),[s,r]=t.useState(!0),[n,a]=t.useState({});return t.useEffect((()=>{!async function(){const s=await async function(e){const s=`/api/question/${e}`;return await he.get(s)}(e);a(s),r(!1)}()}),[e]),{loading:s,questionData:n}}function ze(e={}){const{isStar:s,isDeleted:t}=e,[r]=A(),{data:n,loading:a,error:i,refresh:l}=H((async()=>{const e=r.get(oe)||"",n=parseInt(r.get(de)||"")||1,a=parseInt(r.get(xe)||"")||10;return await be({keyword:e,isStar:s,isDeleted:t,page:n,pageSize:a})}),{refreshDeps:[r]});return{data:n,loading:a,error:i,refresh:l}}const{Title:Oe}=f,{confirm:$e}=_,De=()=>{K("问卷调查");const{data:e={},loading:s,refresh:r}=ze({isDeleted:!0}),{list:n=[],total:a=0}=e,[i,l]=t.useState([]),c=[{title:"标题",dataIndex:"title"},{title:"是否发布",dataIndex:"isPublished",render:e=>e?te.jsx(C,{color:"processing",children:"已发布"}):te.jsx(C,{children:"未发布"})},{title:"答卷",dataIndex:"answerCount"},{title:"创建时间",dataIndex:"createdAt"}],{run:o}=H((async()=>{for await(const e of i)await ve(e,{isDeleted:!1})}),{manual:!0,debounceWait:500,onSuccess(){y.success("恢复成功"),r(),l([])}}),{run:d}=H((async()=>await async function(e){return await he.delete("/api/question",{data:{ids:e}})}(i)),{manual:!0,onSuccess(){y.success("删除成功"),r(),l([])}});return te.jsxs(te.Fragment,{children:[te.jsxs("div",{className:"flex",children:[te.jsx("div",{className:"flex-1",children:te.jsx(Oe,{level:3,children:"回收站"})}),te.jsx("div",{className:"flex-1 text-center",children:te.jsx(qe,{})})]}),te.jsxs("div",{className:"mb-5",children:[s&&te.jsx("div",{className:"text-center",children:te.jsx(E,{})}),!s&&0===n.length&&te.jsx(q,{description:"暂无数据"}),n.length>0&&te.jsxs("div",{children:[te.jsxs(g,{className:"mb",children:[te.jsx(b,{type:"primary",disabled:0===i.length,onClick:o,children:"恢复"}),te.jsx(b,{danger:!0,disabled:0===i.length,onClick:()=>{$e({title:"确定彻底删除该问卷?",icon:te.jsx(u,{}),content:"删除以后不可撤回",onOk:d})},children:"彻底删除"})]}),te.jsx(P,{rowKey:e=>e._id,dataSource:n,columns:c,pagination:!1,rowSelection:{type:"checkbox",onChange:e=>{l(e)}}})]})]}),te.jsx("div",{className:"text-center color-blue",children:n.length>0&&te.jsx(Fe,{total:a})})]})},{Title:Le}=f,Ae=()=>{const{data:e={},loading:s}=ze({isStar:!0}),{list:t=[],total:r=0}=e;return te.jsxs(te.Fragment,{children:[te.jsxs("div",{className:"flex",children:[te.jsx("div",{className:"flex-1",children:te.jsx(Le,{level:3,children:"星标问卷"})}),te.jsx("div",{className:"flex-1 text-center",children:te.jsx(qe,{})})]}),te.jsxs("div",{className:"mb-5",children:[s&&te.jsx("div",{className:"text-center",children:te.jsx(E,{})}),!s&&0===t.length&&te.jsx(q,{description:"暂无数据"}),t.length>0&&t.map((e=>{const{_id:s}=e;return te.jsx(_e,{...e},s)}))]}),te.jsx("div",{className:"text-center color-blue",children:t.length>0&&te.jsx(Fe,{total:r})})]})},Ue=()=>{const{loading:e,questionData:s}=Te();return te.jsxs("div",{children:[te.jsx("p",{children:"编辑"}),e?te.jsx("p",{children:"loading"}):te.jsx("p",{children:JSON.stringify(s)})]})},Me=()=>{const{loading:e,questionData:s}=Te();return te.jsxs("div",{children:[te.jsx("p",{children:"Stat"}),e?te.jsx("p",{children:"loading"}):te.jsx("p",{children:JSON.stringify(s)})]})},{Title:Be,Paragraph:We}=f,He=()=>{const e=$();return te.jsx("div",{className:"h-150 flex flex-col items-center justify-center",children:te.jsxs("div",{className:"text-center",children:[te.jsx(Be,{children:"问卷调查 | 在线投票"}),te.jsx(We,{children:"已经累计创建问卷 500 份，发布问卷 80 份，收到答卷 2000 份"}),te.jsx("div",{className:"h-15 font-24",children:te.jsx(b,{className:"b-rounded-4",type:"primary",onClick:()=>e(Ze),children:"开始使用"})})]})})},{Title:Je}=f,Ke="USERNAME",Ve="PASSWORD",Qe=()=>{const e=$(),[s]=S.useForm();t.useEffect((()=>{const{username:e,password:t}={username:localStorage.getItem(Ke),password:localStorage.getItem(Ve)};s.setFieldsValue({username:e,password:t})}),[]);const{run:r}=H((async(e,s)=>{const t=await async function(e,s){const t={username:e,password:s};return await he.post("/api/user/login",t)}(e,s);return t}),{manual:!0,onSuccess(s){const{token:t=""}=s;!function(e){localStorage.setItem(ce,e)}(t),y.success("登录成功"),e(Ze)}});return te.jsxs("div",{className:"flex flex-col items-center justify-center bg-white",children:[te.jsx("div",{children:te.jsxs(g,{children:[te.jsx(Je,{level:2,children:te.jsx(o,{})}),te.jsx(Je,{level:2,children:"登录"})]})}),te.jsx("div",{children:te.jsxs(S,{labelCol:{span:6},wrapperCol:{span:16},onFinish:e=>{const{username:s,password:t,remember:n}=e||{};r(s,t),n?function(e,s){localStorage.setItem(Ke,e),localStorage.setItem(Ve,s)}(s,t):(localStorage.removeItem(Ke),localStorage.removeItem(Ve))},children:[te.jsx(S.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{type:"string",min:5,max:20,message:"字符长度在 5-20 之间"},{pattern:/^\w+$/,message:"只能所字符下划线"}],children:te.jsx(N,{})}),te.jsx(S.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:te.jsx(N.Password,{})}),te.jsx(S.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:0,span:10},children:te.jsx(F,{children:"记住我"})}),te.jsx(S.Item,{wrapperCol:{offset:4,span:18},children:te.jsxs(g,{children:[te.jsx(b,{type:"primary",htmlType:"submit",children:"登录"}),te.jsx(O,{to:Xe,children:"注册新用户"})]})})]})})]})},Ye=M([{path:"/",element:te.jsx(fe,{}),children:[{path:"/",element:te.jsx(He,{})},{path:"login",element:te.jsx(Qe,{})},{path:"register",element:te.jsx(ke,{})},{path:"manage",element:te.jsx(we,{}),children:[{path:"list",element:te.jsx(Pe,{})},{path:"star",element:te.jsx(Ae,{})},{path:"trash",element:te.jsx(De,{})}]},{path:"*",element:te.jsx(Ce,{})}]},{path:"question",element:te.jsx(Se,{}),children:[{path:"edit/:id",element:te.jsx(Ue,{})},{path:"stat/:id",element:te.jsx(Me,{})}]}],{basename:"/survey-sage"}),Ge="/login",Xe="/register",Ze="/manage/list",es=()=>te.jsx(T,{theme:{algorithm:z.defaultAlgorithm},children:te.jsx(B,{router:Ye})});re.createRoot(document.getElementById("root")).render(te.jsx(j.StrictMode,{children:te.jsx(es,{})}))}}}));
