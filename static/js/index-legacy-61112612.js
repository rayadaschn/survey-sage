System.register(["./@ant-design/icons-legacy-fccabc0f.js","./antd-legacy-235b4b50.js","./react-redux-legacy-0f81e8cf.js","./@reduxjs/toolkit-legacy-a49fdba0.js","./lodash-es-legacy-e3523841.js","./react-router-dom-legacy-51d62e45.js","./axios-legacy-787fab56.js","./ahooks-legacy-ab77c3fa.js","./redux-undo-legacy-0558ac97.js","./recharts-legacy-0f616db0.js"],(function(e,t){"use strict";var s,n,r,l,i,a,c,o,d,x,u,m,h,p,j,g,f,v,y,b,C,w,k,I,N,S,P,_,F,E,V,L,q,R,T,z,A,$,D,O,H,U,B,M,K,W,G,J,Y,X,Q,Z,ee,te,se,ne,re,le,ie,ae,ce,oe,de,xe,ue,me,he,pe,je,ge,fe,ve,ye,be,Ce,we,ke,Ie,Ne,Se,Pe,_e;return{setters:[e=>{s=e.r,n=e.ae,r=e.af,l=e.U,i=e.M,a=e.ag,c=e.ah,o=e.ai,d=e.ac,x=e.aj,u=e.ad,m=e.ak,h=e.W,p=e.al,j=e.am,g=e.an,f=e.K,v=e.ao,y=e.ap,b=e.O,C=e.aq,w=e.z,k=e.ar,I=e.as,N=e.at,S=e.R},e=>{P=e.r,_=e.S,F=e.m,E=e.B,V=e.L,L=e.a,q=e.D,R=e.F,T=e.I,z=e.T,A=e.R,$=e.b,D=e.P,O=e.M,H=e.E,U=e.c,B=e.d,M=e.e,K=e.C,W=e.f,G=e.g,J=e.h,Y=e.i,X=e.j,Q=e.t},e=>{Z=e.u,ee=e.a,te=e.P},e=>{se=e.c,ne=e.p,re=e.a},e=>{le=e.c},e=>{ie=e.L,ae=e.u,ce=e.a,oe=e.b,de=e.c,xe=e.O,ue=e.d,me=e.R},e=>{he=e.a},e=>{pe=e.F,je=e.G,ge=e.H,fe=e.I},e=>{ve=e.M},e=>{ye=e.R,be=e.B,Ce=e.C,we=e.X,ke=e.Y,Ie=e.T,Ne=e.a,Se=e.P,Pe=e.b,_e=e.c}],execute:function(){var e=document.createElement("style");e.textContent='#--unocss--{layer:__ALL__}:root{--w-space-xs: 8px;--w-space-sm: 16px;--w-space: 24px;--w-space-lg: 32px;--w-radius-xs: 4px;--w-radius: 8px;--w-radius-lg: 12px;--w-radius-xl: 16px;--c-white: #fff;--c-black: #000;--c-blue: #3b82f6;--c-red: #ef4444;--c-yellow: #f59e0b;--c-green: #42b983;--c-gray: #9ca3af;--c-disable: rgba(0, 0, 0, .25);--c-brand: var(--c-green);--c-bg: #f8f8f8;--c-text: #374151;--c-tips: var(--c-gray);--c-border: var(--c-gray);--c-mask: rgba(0, 0, 0, .7);--c-hover: var(--c-brand)}:root.dark{--c-bg: #181818;--c-text: #e5e7eb}html{width:100%;overflow-x:hidden}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:"tnum";font-variant:tabular-nums;background-color:var(--c-bg);margin:0}::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-thumb{background-color:#374151;border-radius:4px}::-webkit-scrollbar-thumb:hover{background-color:#1f2937}::-webkit-scrollbar-track{background-color:#6b7280;border-radius:4px}\n',document.head.appendChild(e);var t={exports:{}},Fe={},Ee=s,Ve=Symbol.for("react.element"),Le=Symbol.for("react.fragment"),qe=Object.prototype.hasOwnProperty,Re=Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Te={key:!0,ref:!0,__self:!0,__source:!0};function ze(e,t,s){var n,r={},l=null,i=null;for(n in void 0!==s&&(l=""+s),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(i=t.ref),t)qe.call(t,n)&&!Te.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:Ve,type:e,key:l,ref:i,props:r,_owner:Re.current}}Fe.Fragment=Le,Fe.jsx=ze,Fe.jsxs=ze,t.exports=Fe;var Ae=t.exports,$e={},De=P;$e.createRoot=De.createRoot,$e.hydrateRoot=De.hydrateRoot;const Oe={username:"",nickname:""},He=se({name:"user",initialState:Oe,reducers:{loginReducer:(e,t)=>t.payload,logoutReducer:()=>Oe}}),Ue=He.reducer,{loginReducer:Be,logoutReducer:Me}=He.actions,Ke=se({name:"pageInfo",initialState:{title:"",desc:"",js:"",css:""},reducers:{resetPageInfo:(e,t)=>t.payload}}),We=Ke.reducer,{resetPageInfo:Ge}=Ke.actions;let Je=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"");function Ye(e,t){const s=t.filter((e=>!e.isHidden)),n=s.findIndex((t=>t.fe_id===e));if(n<0)return"";let r="";const l=s.length;return r=l<=1?"":n+1===l?s[n-1].fe_id:s[n+1].fe_id,r}function Xe(e,t){const{selectedId:s,componentList:n}=e,r=n.findIndex((e=>e.fe_id===s));r<0?e.componentList.push(t):e.componentList.splice(r+1,0,t),e.selectedId=t.fe_id}const Qe=se({name:"components",initialState:{componentList:[],selectedId:"",copiedComponent:null},reducers:{resetComponents:(e,t)=>t.payload,changeSelectedId:ne(((e,t)=>{e.selectedId=t.payload})),addComponent:ne(((e,t)=>{Xe(e,t.payload)})),changeComponentProps:ne(((e,t)=>{const{fe_id:s,newProps:n}=t.payload,r=e.componentList.find((e=>e.fe_id===s));r&&(r.props={...r.props,...n})})),removeSelectedComponent:ne((e=>{const{componentList:t=[],selectedId:s}=e,n=Ye(s,t);e.selectedId=n;const r=t.findIndex((e=>e.fe_id===s));t.splice(r,1)})),changeComponentHidden:ne(((e,t)=>{const{componentList:s=[]}=e,{fe_id:n,isHidden:r}=t.payload;let l="";l=r?Ye(n,s):n,e.selectedId=l;const i=s.find((e=>e.fe_id===n));i&&(i.isHidden=r)})),toggleComponentLocked:ne(((e,t)=>{const{fe_id:s}=t.payload,n=e.componentList.find((e=>e.fe_id===s));n&&(n.isLocked=!n.isLocked)})),copySelectedComponent:ne((e=>{const{selectedId:t,componentList:s=[]}=e,n=s.find((e=>e.fe_id===t));null!=n&&(e.copiedComponent=le(n))})),pasteCopiedComponent:ne((e=>{const{copiedComponent:t}=e;null!=t&&(t.fe_id=Je(),Xe(e,t))})),selectPrevComponent:ne((e=>{const{selectedId:t,componentList:s}=e,n=s.findIndex((e=>e.fe_id===t));n<0||n<=0||(e.selectedId=s[n-1].fe_id)})),selectNextComponent:ne((e=>{const{selectedId:t,componentList:s}=e,n=s.findIndex((e=>e.fe_id===t));n<0||n+1!==s.length&&(e.selectedId=s[n+1].fe_id)})),changeComponentTitle:ne(((e,t)=>{const{title:s,fe_id:n}=t.payload,r=e.componentList.find((e=>e.fe_id===n));r&&(r.title=s)})),moveComponent:ne(((e,t)=>{t.payload}))}}),{resetComponents:Ze,changeSelectedId:et,addComponent:tt,changeComponentProps:st,removeSelectedComponent:nt,changeComponentHidden:rt,toggleComponentLocked:lt,copySelectedComponent:it,pasteCopiedComponent:at,selectPrevComponent:ct,selectNextComponent:ot,changeComponentTitle:dt,moveComponent:xt}=Qe.actions,ut=Qe.reducer,mt=re({reducer:{user:Ue,pageInfo:We,components:ut}}),ht=()=>Ae.jsx("div",{children:Ae.jsx(ie,{to:"/",children:Ae.jsx(_,{children:Ae.jsxs("div",{className:"text-7 color-white",children:[Ae.jsx(n,{}),Ae.jsx("span",{children:"问卷调查"})]})})})}),pt="keyword",jt="page",gt="pageSize",ft=["#FF2D2D","#BE77FF","#2894FF","#00EC00","#EAC100","#FF9D6F"],vt=he.create({timeout:1e4,baseURL:"https://huy.wiki:3002/"});vt.interceptors.request.use((e=>(e.headers.Authorization=`Bearer ${localStorage.getItem(yt)||""}`,e)),(e=>(F.error(e.message),Promise.reject(e)))),vt.interceptors.response.use((e=>{const t=e.data||{},{errno:s,data:n,msg:r}=t;return 203===s||0!==s&&200!==s?(F.error(r||"请求失败"),Promise.reject(n)):n}),(e=>{let t="";const s=e.response?.status;switch(s){case 401:t="token 失效，请重新登录";break;case 403:t="拒绝访问";break;case 404:t="请求地址错误";break;case 500:t="服务器故障";break;default:t="网络连接故障"}return F.error(t),Promise.reject(e)}));const yt="USER_TOKEN",bt=()=>document.activeElement===document.body;function Ct(){const e=ee((e=>e.components)),{componentList:t=[],selectedId:s,copiedComponent:n}=e,r=t.find((e=>e.fe_id===s));return{componentList:t,selectedId:s,selectedComponent:r,copiedComponent:n}}function wt(){return ee((e=>e.pageInfo))}function kt(){const{username:e,nickname:t}=ee((e=>e.user));return{username:e,nickname:t}}async function It(){return await vt.post("/api/question/")}async function Nt(e={}){return await vt.get("/api/question",{params:e})}async function St(e,t){const s=`/api/question/${e}`;return await vt.patch(s,t)}async function Pt(){return await vt.get("/api/user/info")}function _t(){const{id:e=""}=ae(),t=Z(),{data:n,loading:r,error:l,run:i}=je((async e=>{if(!e)throw new Error("缺少问卷 id");const t=await async function(e){const t=`/api/question/${e}`;return await vt.get(t)}(e);return t}),{manual:!0});return s.useEffect((()=>{if(!n)return;const{title:e="",desc:s="",js:r="",css:l="",componentList:i=[]}=n;let a="";i.length>0&&(a=i[0].fe_id),t(Ze({componentList:i,selectedId:a,copiedComponent:null})),t(Ge({title:e,desc:s,js:r,css:l}))}),[n]),s.useEffect((()=>{i(e)}),[e]),{loading:r,error:l}}function Ft(e={}){const{isStar:t,isDeleted:s}=e,[n]=ce(),{data:r,loading:l,error:i,refresh:a}=je((async()=>{const e=n.get(pt)||"",r=parseInt(n.get(jt)||"")||1,l=parseInt(n.get(gt)||"")||10;return await Nt({keyword:e,isStar:t,isDeleted:s,page:r,pageSize:l})}),{refreshDeps:[n]});return{data:r,loading:l,error:i,refresh:a}}function Et(){const e=Z(),[t,n]=s.useState(!0),{run:r}=je(Pt,{manual:!0,onSuccess(t){const{username:s,nickname:n}=t;e(Be({username:s,nickname:n}))},onFinally(){n(!1)}}),{username:l}=kt();return s.useEffect((()=>{l?n(!1):r()}),[t]),{waitingUserData:t}}function Vt(e){const{username:t}=kt(),{pathname:n}=oe(),r=de();s.useEffect((()=>{e||(t?function(e){return[Xs,Qs].includes(e)}(n)&&r(Zs):function(e){return[Ys,Xs,Qs].includes(e)}(n)||r(Xs))}),[e,t,n])}const Lt=()=>{const e=de(),t=Z(),{username:s,nickname:n}=kt(),l=Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("span",{className:"color-light",children:[Ae.jsx(r,{}),n]}),Ae.jsx(E,{type:"link",onClick:function(){t(Me()),localStorage.removeItem(yt),F.success("退出成功"),e(Xs)},children:"退出"})]}),i=Ae.jsx(ie,{to:Xs,children:"登录"});return Ae.jsx(Ae.Fragment,{children:s?l:i})},{Header:qt,Content:Rt,Footer:Tt}=V,zt=()=>{const{waitingUserData:e}=Et();return Vt(e),Ae.jsxs(V,{children:[Ae.jsxs(qt,{className:"px-6",children:[Ae.jsx("div",{className:"float-left",children:Ae.jsx(ht,{})}),"MainLayout header",Ae.jsx("div",{className:"float-right",children:Ae.jsx(Lt,{})})]}),Ae.jsx(Rt,{className:"min-h-[calc(100vh-140px)]",children:e?Ae.jsx("div",{className:"mt-15 text-center",children:Ae.jsx(L,{})}):Ae.jsx(xe,{})}),Ae.jsx(Tt,{className:"border-t border-gray-200 border-solid bg-white text-center",children:"问卷调查 ©2023 - present. Created by Huy"})]})},At=()=>{const e=de(),{pathname:t}=oe(),{loading:s,run:n}=je(It,{manual:!0,onSuccess(t){e(`question/edit/${t.id}`),F.success("创建成功")}});return Ae.jsxs("div",{className:"mx-auto my-0 w-300 flex py-6",children:[Ae.jsx("div",{className:"w-30",children:Ae.jsxs(_,{direction:"vertical",children:[Ae.jsx(E,{type:"primary",size:"large",icon:Ae.jsx(l,{}),onClick:n,disabled:s,children:"新建问卷"}),Ae.jsx(q,{}),Ae.jsx(E,{type:t.startsWith("/manage/list")?"default":"text",size:"large",icon:Ae.jsx(i,{}),onClick:()=>e("/manage/list"),children:"我的问卷"}),Ae.jsx(E,{type:t.startsWith("/manage/star")?"default":"text",size:"large",icon:Ae.jsx(a,{}),onClick:()=>e("/manage/star"),children:"星标问卷"}),Ae.jsx(E,{type:t.startsWith("/manage/trash")?"default":"text",size:"large",icon:Ae.jsx(c,{}),onClick:()=>e("/manage/trash"),children:"回收站"})]})}),Ae.jsx("div",{className:"ml-15 flex-1",children:Ae.jsx(xe,{})})]})},$t=()=>{const{waitingUserData:e}=Et();return Vt(e),Ae.jsx("div",{className:"h-screen",children:e?Ae.jsx("div",{className:"mt-15 text-center",children:Ae.jsx(L,{})}):Ae.jsx(xe,{})})},{Title:Dt}=z,Ot=()=>{const e=de(),{run:t}=je((async e=>{const{username:t,password:s,nickname:n}=e;await async function(e,t,s){const n={username:e,password:t,nickname:s||e};return await vt.post("/api/user/register",n)}(t,s,n)}),{manual:!0,onSuccess(){F.success("注册成功"),e(Xs)}});return Ae.jsxs("div",{className:"flex flex-col items-center justify-center bg-white",children:[Ae.jsx("div",{children:Ae.jsxs(_,{children:[Ae.jsx(Dt,{level:2,children:Ae.jsx(o,{})}),Ae.jsx(Dt,{level:2,children:"注册新用户"})]})}),Ae.jsx("div",{children:Ae.jsxs(R,{labelCol:{span:6},wrapperCol:{span:16},onFinish:e=>{t(e)},children:[Ae.jsx(R.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{type:"string",min:5,max:20,message:"字符长度在 5-20 之间"},{pattern:/^\w+$/,message:"只能所字符下划线"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:Ae.jsx(T.Password,{})}),Ae.jsx(R.Item,{label:"确认密码",name:" confirm",rules:[{required:!0,message:"请输入密码"},({getFieldValue:e})=>({validator:(t,s)=>s&&e("password")!==s?Promise.reject(new Error("两次密码不一致")):Promise.resolve()})],children:Ae.jsx(T.Password,{})}),Ae.jsx(R.Item,{label:"昵称",name:"nickname",children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{wrapperCol:{offset:4,span:18},children:Ae.jsxs(_,{children:[Ae.jsx(E,{type:"primary",htmlType:"submit",children:"注册"}),Ae.jsx(ie,{to:Xs,children:"已有账户，请登录"})]})})]})})]})},Ht=()=>{const e=de();return Ae.jsx(Ae.Fragment,{children:Ae.jsx(A,{status:"404",title:"404",subTitle:"抱歉，您访问的页面不存在",extra:Ae.jsx(E,{type:"primary",onClick:()=>e(Zs),children:"返回首页"})})})},{confirm:Ut}=O,Bt=e=>{const t=de(),{_id:n,title:r,isPublished:l,answerContent:i,currentAt:o,isStar:h}=e,[p,j]=s.useState(h),{loading:g,run:f}=je((async()=>{await St(n,{isStar:!p})}),{manual:!0,onSuccess(){j(!p),F.success("已更新")}}),{loading:v,run:y}=je((async()=>await async function(e){const t=`/api/question/duplicate/${e}`;return await vt.post(t)}(n)),{manual:!0,onSuccess(e){F.success("复制成功"),t(`/question/edit/${e.id}`)}}),[b,C]=s.useState(!1),{loading:w,run:k}=je((async()=>await St(n,{isDeleted:!0})),{manual:!0,onSuccess(){F.success("删除成功"),C(!0)}});return b?null:Ae.jsxs("div",{className:"mb-2.5 border-rounded bg-white p-3 transition-transform hover:scale-105 hover:transform hover:shadow-md",children:[Ae.jsxs("div",{className:"flex",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsx(ie,{to:l?`/question/stat/${n}`:`/question/edit/${n}`,children:Ae.jsxs(_,{children:[h&&Ae.jsx(a,{style:{color:"red"}}),r]})})}),Ae.jsx("div",{className:"flex-1 text-center font-size-3",children:Ae.jsxs(_,{children:[l?Ae.jsx($,{color:"processing",children:"已发布"}):Ae.jsx($,{children:"未发布"}),Ae.jsxs("span",{children:["答卷: ",i]}),Ae.jsx("span",{children:o})]})})]}),Ae.jsx(q,{className:"m-3"}),Ae.jsxs("div",{className:"flex",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsxs(_,{children:[Ae.jsx(E,{icon:Ae.jsx(d,{}),type:"text",size:"small",onClick:()=>{t(`/question/edit/${n}`)},children:"编辑问卷"}),Ae.jsx(E,{icon:Ae.jsx(x,{}),type:"text",size:"small",onClick:()=>{t(`/question/stat/${n}`)},children:"数据统计"})]})}),Ae.jsx("div",{className:"flex-1 text-center",children:Ae.jsxs(_,{children:[Ae.jsx(E,{type:"text",icon:Ae.jsx(a,{}),color:"#999",size:"small",onClick:f,disabled:g,children:p?"取消标星":"标星"}),Ae.jsx(D,{title:"确定复制该问卷?",okText:"确认",cancelText:"取消",onConfirm:y,children:Ae.jsx(E,{type:"text",icon:Ae.jsx(u,{}),color:"#999",size:"small",disabled:v,children:"复制"})}),Ae.jsx(E,{type:"text",icon:Ae.jsx(c,{}),size:"small",color:"#999",onClick:()=>{Ut({title:"确定删除该问卷?",icon:Ae.jsx(m,{}),onOk:k})},disabled:w,children:"删除"})]})})]})]})},{Search:Mt}=T,Kt=()=>{const e=de(),{pathname:t}=oe(),[n,r]=s.useState(""),[l]=ce();return s.useEffect((()=>{const e=l.get(pt)||"";r(e)}),[l]),Ae.jsx(Mt,{placeholder:"请输入关键字",value:n,onChange:function(e){r(e.target.value)},onSearch:function(s){e({pathname:t,search:`${pt}=${s}`})},className:"w-50"})},{Title:Wt}=z,Gt=()=>{const[e,t]=s.useState(!1),[n,r]=s.useState(1),[l,i]=s.useState([]),[a,c]=s.useState(0),o=a>l.length,[d]=ce(),x=d.get(pt)||"";s.useEffect((()=>{t(!1),r(1),i([]),c(0)}),[x]);const{run:u,loading:m}=je((async()=>await Nt({page:n,pageSize:10,keyword:x})),{manual:!0,onSuccess(e){const{list:t=[],total:s=0}=e;i(l.concat(t)),c(s),r(n+1)}}),h=s.useRef(null),{run:p}=ge((()=>{const e=h.current;if(null==e)return;const s=e.getBoundingClientRect();if(null==s)return;const{bottom:n}=s;n<=document.body.clientHeight&&(u(),t(!0))}),{wait:1e3});s.useEffect((()=>{p()}),[d]),s.useEffect((()=>(o&&window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)})),[d,o]);const j=s.useMemo((()=>!e||m?Ae.jsx(L,{}):0===a?Ae.jsx(H,{description:"暂无数据"}):o?Ae.jsx("span",{children:"开始加载下一页"}):Ae.jsx("span",{children:"没有更多了..."})),[e,m,o]);return Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"flex",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsx(Wt,{level:3,children:"我的问卷"})}),Ae.jsx("div",{className:"flex-1 text-center",children:Ae.jsx(Kt,{})})]}),Ae.jsx("div",{className:"mb-5",children:l.length>0&&l.map((e=>{const{_id:t}=e;return Ae.jsx(Bt,{...e},t)}))}),Ae.jsx("div",{className:"text-center color-blue",children:Ae.jsx("div",{ref:h,children:j})})]})},Jt=e=>{const{total:t}=e,[n,r]=s.useState(1),[l,i]=s.useState(10),[a]=ce();s.useEffect((()=>{const e=parseInt(a.get(jt)||"")||1;r(e);const t=parseInt(a.get(gt)||"")||10;i(t)}),[a]);const c=de(),{pathname:o}=oe();return Ae.jsx(U,{current:n,pageSize:l,total:t,onChange:(e,t)=>{a.set(jt,e.toString()),a.set(gt,t.toString()),c({pathname:o,search:a.toString()})}})},{Title:Yt}=z,{confirm:Xt}=O,Qt=()=>{fe("问卷调查");const{data:e={},loading:t,refresh:n}=Ft({isDeleted:!0}),{list:r=[],total:l=0}=e,[i,a]=s.useState([]),c=[{title:"标题",dataIndex:"title"},{title:"是否发布",dataIndex:"isPublished",render:e=>e?Ae.jsx($,{color:"processing",children:"已发布"}):Ae.jsx($,{children:"未发布"})},{title:"答卷",dataIndex:"answerCount"},{title:"创建时间",dataIndex:"createdAt"}],{run:o}=je((async()=>{for await(const e of i)await St(e,{isDeleted:!1})}),{manual:!0,debounceWait:500,onSuccess(){F.success("恢复成功"),n(),a([])}}),{run:d}=je((async()=>await async function(e){return await vt.delete("/api/question",{data:{ids:e}})}(i)),{manual:!0,onSuccess(){F.success("删除成功"),n(),a([])}});return Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"flex",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsx(Yt,{level:3,children:"回收站"})}),Ae.jsx("div",{className:"flex-1 text-center",children:Ae.jsx(Kt,{})})]}),Ae.jsxs("div",{className:"mb-5",children:[t&&Ae.jsx("div",{className:"text-center",children:Ae.jsx(L,{})}),!t&&0===r.length&&Ae.jsx(H,{description:"暂无数据"}),r.length>0&&Ae.jsxs("div",{children:[Ae.jsxs(_,{className:"mb",children:[Ae.jsx(E,{type:"primary",disabled:0===i.length,onClick:o,children:"恢复"}),Ae.jsx(E,{danger:!0,disabled:0===i.length,onClick:()=>{Xt({title:"确定彻底删除该问卷?",icon:Ae.jsx(m,{}),content:"删除以后不可撤回",onOk:d})},children:"彻底删除"})]}),Ae.jsx(B,{rowKey:e=>e._id,dataSource:r,columns:c,pagination:!1,rowSelection:{type:"checkbox",onChange:e=>{a(e)}}})]})]}),Ae.jsx("div",{className:"text-center color-blue",children:r.length>0&&Ae.jsx(Jt,{total:l})})]})},{Title:Zt}=z,es=()=>{const{data:e={},loading:t}=Ft({isStar:!0}),{list:s=[],total:n=0}=e;return Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"flex",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsx(Zt,{level:3,children:"星标问卷"})}),Ae.jsx("div",{className:"flex-1 text-center",children:Ae.jsx(Kt,{})})]}),Ae.jsxs("div",{className:"mb-5",children:[t&&Ae.jsx("div",{className:"text-center",children:Ae.jsx(L,{})}),!t&&0===s.length&&Ae.jsx(H,{description:"暂无数据"}),s.length>0&&s.map((e=>{const{_id:t}=e;return Ae.jsx(Bt,{...e},t)}))]}),Ae.jsx("div",{className:"text-center color-blue",children:s.length>0&&Ae.jsx(Jt,{total:n})})]})},ts=()=>{const e=Z(),{selectedId:t,componentList:s,selectedComponent:n,copiedComponent:r}=Ct(),l=s.findIndex((e=>e.fe_id===t)),i=l<=0,a=l+1>=s.length,o=n?.isLocked?"primary":"default",d=[{title:"删除",shape:"circle",icon:Ae.jsx(c,{}),onClick:()=>{e(nt())}},{title:"隐藏",shape:"circle",icon:Ae.jsx(h,{}),onClick:()=>{e(rt({fe_id:t,isHidden:!0}))}},{title:"锁定",type:o,shape:"circle",icon:Ae.jsx(p,{}),onClick:()=>{e(lt({fe_id:t}))}},{title:"复制",shape:"circle",icon:Ae.jsx(u,{}),onClick:()=>{e(it())}},{title:"粘贴",shape:"circle",icon:Ae.jsx(j,{}),onClick:()=>{e(at())},disabled:null==r},{title:"上移",shape:"circle",icon:Ae.jsx(g,{}),onClick:()=>{i||e(xt({oldIndex:l,newIndex:l-1}))},disabled:i},{title:"下移",shape:"circle",icon:Ae.jsx(f,{}),onClick:()=>{a||e(xt({oldIndex:l,newIndex:l+1}))},disabled:a},{title:"撤销",shape:"circle",icon:Ae.jsx(v,{}),onClick:()=>{e(ve.undo())}},{title:"重做",shape:"circle",icon:Ae.jsx(y,{}),onClick:()=>{e(ve.redo())}}];return Ae.jsx(_,{children:d.map((e=>{const{title:t,type:s,shape:n,icon:r,onClick:l,disabled:i}=e;return Ae.jsx(M,{title:t,children:Ae.jsx(E,{type:s,shape:n,icon:r,onClick:l,disabled:i})},t)}))})},ss=()=>{const e=de();return Ae.jsxs("div",{className:"mx-6 flex border-b border-green-300 bg-white py-4",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsxs(_,{children:[Ae.jsx(E,{type:"link",icon:Ae.jsx(b,{}),onClick:()=>e(-1),children:"返回"}),Ae.jsx("div",{className:"mb-0 text-[18px] leading-none",children:"标题"})]})}),Ae.jsx("div",{className:"flex-1 text-center leading-[2]",children:Ae.jsx(ts,{})}),Ae.jsx("div",{className:"mr-3 flex-1 text-right leading-[2]",children:Ae.jsxs(_,{children:[Ae.jsx(E,{children:"保存"}),Ae.jsx(E,{type:"primary",children:"发布"})]})})]})},ns={title:"多选标题",isVertical:!1,list:[{value:"item1",text:"选项1",checked:!1},{value:"item2",text:"选项2",checked:!1},{value:"item3",text:"选项3",checked:!1}]},{Paragraph:rs}=z,ls={title:"多选",type:"questionCheckbox",Component:e=>{const{title:t,isVertical:s,list:n=[]}={...ns,...e};return Ae.jsxs("div",{children:[Ae.jsx(rs,{strong:!0,children:t}),Ae.jsx(_,{direction:s?"vertical":"horizontal",children:n.map((e=>{const{value:t,text:s,checked:n}=e;return Ae.jsx(K,{value:t,checked:n,children:s},t)}))})]})},PropComponent:e=>{const{title:t,isVertical:s,list:n=[],onChange:r,disabled:i}=e,[a]=R.useForm();return Ae.jsxs(R,{layout:"vertical",form:a,initialValues:{title:t,isVertical:s,list:n},disabled:i,onValuesChange:()=>{if(null==r)return;const e=a.getFieldsValue();e.list&&(e.list=e.list.filter((e=>!(null==e.text))));const{list:t=[]}=e;t.forEach((e=>{e.value||(e.value=Je(5))})),r(e)},children:[Ae.jsx(R.Item,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"选项",children:Ae.jsx(R.List,{name:"list",children:(e,{add:t,remove:s})=>Ae.jsxs(Ae.Fragment,{children:[e.map((({key:e,name:t},n)=>Ae.jsxs(_,{align:"baseline",children:[Ae.jsx(R.Item,{name:[t,"checked"],valuePropName:"checked",children:Ae.jsx(K,{})}),Ae.jsx(R.Item,{name:[t,"text"],rules:[{required:!0,message:"请输入选项文字"},{validator:(e,t)=>{const{list:s=[]}=a.getFieldsValue();let n=0;return s.forEach((e=>{e.text===t&&n++})),1===n?Promise.resolve():Promise.reject(new Error("和其他选项重复了"))}}],children:Ae.jsx(T,{placeholder:"输入选项文字..."})}),n>0&&Ae.jsx(C,{onClick:()=>s(t)})]},e))),Ae.jsx(R.Item,{children:Ae.jsx(E,{type:"link",onClick:()=>t({text:"",value:"",checked:!1}),icon:Ae.jsx(l,{}),block:!0,children:"添加选项"})})]})})}),Ae.jsx(R.Item,{name:"isVertical",valuePropName:"checked",children:Ae.jsx(K,{children:"竖向排列"})})]})},StatComponent:({stat:e})=>Ae.jsx("div",{style:{width:"400px",height:"300px"},children:Ae.jsx(ye,{width:"100%",height:"100%",children:Ae.jsxs(be,{width:400,height:300,data:e,margin:{top:5,right:30,left:0,bottom:5},children:[Ae.jsx(Ce,{strokeDasharray:"3 3"}),Ae.jsx(we,{dataKey:"name"}),Ae.jsx(ke,{}),Ae.jsx(Ie,{}),Ae.jsx(Ne,{dataKey:"count",fill:"#8884d8"})]})})}),defaultProps:ns},is={title:"问卷标题",desc:"问卷描述"},{Title:as,Paragraph:cs}=z,{TextArea:os}=T,ds={title:"问卷信息",type:"questionInfo",Component:e=>{const{title:t,desc:s=""}={...is,...e},n=s.split("\n");return Ae.jsxs("div",{style:{textAlign:"center"},children:[Ae.jsx(as,{style:{fontSize:"24px"},children:t}),Ae.jsx(cs,{children:n.map(((e,t)=>Ae.jsxs("span",{children:[t>0&&Ae.jsx("br",{}),e]},t)))})]})},PropComponent:e=>{const{title:t,desc:n,onChange:r,disabled:l}=e,[i]=R.useForm();return s.useEffect((()=>{i.setFieldsValue({title:t,desc:n})}),[t,n]),Ae.jsxs(R,{layout:"vertical",initialValues:{title:t,desc:n},onValuesChange:function(){r&&r(i.getFieldsValue())},disabled:l,form:i,children:[Ae.jsx(R.Item,{label:"标题",name:"title",rules:[{required:!0,message:"请输入问卷标题"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"描述",name:"desc",children:Ae.jsx(os,{})})]})},defaultProps:is},xs={title:"输入框标题",placeholder:"请输入..."},{Paragraph:us}=z,ms={title:"输入框",type:"questionInput",Component:e=>{const{title:t,placeholder:s}={...xs,...e};return Ae.jsxs("div",{children:[Ae.jsx(us,{strong:!0,children:t}),Ae.jsx("div",{children:Ae.jsx(T,{placeholder:s})})]})},PropComponent:e=>{const{title:t,placeholder:n,onChange:r,disabled:l}=e,[i]=R.useForm();return s.useEffect((()=>{i.setFieldsValue({title:t,placeholder:n})}),[t,n]),Ae.jsxs(R,{layout:"vertical",initialValues:{title:t,placeholder:n},form:i,onValuesChange:function(){r&&r(i.getFieldsValue())},disabled:l,children:[Ae.jsx(R.Item,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"Placeholder",name:"placeholder",children:Ae.jsx(T,{})})]})},defaultProps:xs},hs={text:"一行段落",isCenter:!1},{Paragraph:ps}=z,{TextArea:js}=T,gs={title:"段落",type:"questionParagraph",Component:e=>{const{text:t="",isCenter:s=!1}={...hs,...e},n=t.split("\n");return Ae.jsx(ps,{style:{textAlign:s?"center":"start",marginBottom:"0"},children:n.map(((e,t)=>Ae.jsxs("span",{children:[t>0&&Ae.jsx("br",{}),e]},t)))})},PropComponent:e=>{const{text:t,isCenter:n,onChange:r,disabled:l}=e,[i]=R.useForm();return s.useEffect((()=>{i.setFieldsValue({text:t,isCenter:n})}),[t,n]),Ae.jsxs(R,{layout:"vertical",initialValues:{text:t,isCenter:n},onValuesChange:function(){r&&r(i.getFieldsValue())},disabled:l,form:i,children:[Ae.jsx(R.Item,{label:"段落内容",name:"text",rules:[{required:!0,message:"请输入段落内容"}],children:Ae.jsx(js,{})}),Ae.jsx(R.Item,{name:"isCenter",valuePropName:"checked",children:Ae.jsx(K,{children:"居中显示"})})]})},defaultProps:hs},fs={title:"单选标题",isVertical:!1,options:[{value:"item1",text:"选项1"},{value:"item2",text:"选项2"},{value:"item3",text:"选项3"}],value:""},{Paragraph:vs}=z,ys={title:"单选",type:"questionRadio",Component:e=>{const{title:t,options:s=[],value:n,isVertical:r}={...fs,...e};return Ae.jsxs("div",{children:[Ae.jsx(vs,{strong:!0,children:t}),Ae.jsx(W.Group,{value:n,children:Ae.jsx(_,{direction:r?"vertical":"horizontal",children:s.map((e=>{const{value:t,text:s}=e;return Ae.jsx(W,{value:t,children:s},t)}))})})]})},PropComponent:e=>{const{title:t,isVertical:n,value:r,options:i=[],onChange:a,disabled:c}=e,[o]=R.useForm();return s.useEffect((()=>{o.setFieldsValue({title:t,isVertical:n,value:r,options:i})}),[t,n,r,i]),Ae.jsxs(R,{layout:"vertical",initialValues:{title:t,isVertical:n,value:r,options:i},onValuesChange:function(){if(null==a)return;const e=o.getFieldsValue();e.options&&(e.options=e.options.filter((e=>!(null==e.text))));const{options:t=[]}=e;t.forEach((e=>{e.value||(e.value=Je(5))})),a(e)},disabled:c,form:o,children:[Ae.jsx(R.Item,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"选项",children:Ae.jsx(R.List,{name:"options",children:(e,{add:t,remove:s})=>Ae.jsxs(Ae.Fragment,{children:[e.map((({key:e,name:t},n)=>Ae.jsxs(_,{align:"baseline",children:[Ae.jsx(R.Item,{name:[t,"text"],rules:[{required:!0,message:"请输入选项文字"},{validator:(e,t)=>{const{options:s=[]}=o.getFieldsValue();let n=0;return s.forEach((e=>{e.text===t&&n++})),1===n?Promise.resolve():Promise.reject(new Error("和其他选项重复了"))}}],children:Ae.jsx(T,{placeholder:"输入选项文字..."})}),n>1&&Ae.jsx(C,{onClick:()=>s(t)})]},e))),Ae.jsx(R.Item,{children:Ae.jsx(E,{type:"link",onClick:()=>t({text:"",value:""}),icon:Ae.jsx(l,{}),block:!0,children:"添加选项"})})]})})}),Ae.jsx(R.Item,{label:"默认选中",name:"value",children:Ae.jsx(G,{value:r,options:i.map((({text:e,value:t})=>({value:t,label:e||""})))})}),Ae.jsx(R.Item,{name:"isVertical",valuePropName:"checked",children:Ae.jsx(K,{children:"竖向排列"})})]})},defaultProps:fs,StatComponent:({stat:e=[]})=>{const t=s.useMemo((()=>{let t=0;return e.forEach((e=>t+=e.count)),t}),[e]);return Ae.jsx("div",{style:{width:"300px",height:"400px"},children:Ae.jsx(ye,{width:"100%",height:"100%",children:Ae.jsxs(Se,{children:[Ae.jsx(Pe,{dataKey:"count",data:e,cx:"50%",cy:"50%",outerRadius:50,fill:"#8884d8",label:e=>`${e.name}: ${function(e){return(100*e).toFixed(2)}(e.count/t)}%`,children:e.map(((e,t)=>Ae.jsx(_e,{fill:ft[t]},t)))}),Ae.jsx(Ie,{})]})})})}},bs={title:"输入框标题",placeholder:"请输入..."},{Paragraph:Cs}=z,{TextArea:ws}=T,ks={title:"多行输入",type:"questionTextarea",Component:e=>{const{title:t,placeholder:s}={...bs,...e};return Ae.jsxs("div",{children:[Ae.jsx(Cs,{strong:!0,children:t}),Ae.jsx("div",{children:Ae.jsx(ws,{placeholder:s})})]})},PropComponent:e=>{const{title:t,placeholder:n,onChange:r,disabled:l}=e,[i]=R.useForm();return s.useEffect((()=>{i.setFieldsValue({title:t,placeholder:n})}),[t,n]),Ae.jsxs(R,{layout:"vertical",initialValues:{title:t,placeholder:n},form:i,onValuesChange:function(){r&&r(i.getFieldsValue())},disabled:l,children:[Ae.jsx(R.Item,{label:"标题",name:"title",rules:[{required:!0,message:"请输入标题"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"Placeholder",name:"placeholder",children:Ae.jsx(T,{})})]})},defaultProps:bs},Is={text:"一级标题",level:1,isCenter:!1},{Title:Ns}=z,Ss={title:"标题",type:"questionTitle",Component:e=>{const{text:t="",level:s=1,isCenter:n=!1}={...Is,...e};return Ae.jsx(Ns,{level:s,style:{textAlign:n?"center":"start",marginBottom:"0",fontSize:(r=s,1===r?"24px":2===r?"20px":"16px")},children:t});var r},PropComponent:e=>{const{text:t,level:n,isCenter:r,onChange:l,disabled:i}=e,[a]=R.useForm();return s.useEffect((()=>{a.setFieldsValue({text:t,level:n,isCenter:r})}),[t,n,r]),Ae.jsxs(R,{form:a,layout:"vertical",onValuesChange:function(){l&&l(a.getFieldsValue())},initialValues:{text:t,level:n,isCenter:r},disabled:i,children:[Ae.jsx(R.Item,{label:"标题内容",name:"text",rules:[{required:!0,message:"请输入标题内容"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"层级",name:"level",children:Ae.jsx(G,{options:[{value:1,text:1},{value:2,text:2},{value:3,text:3}]})}),Ae.jsx(R.Item,{name:"isCenter",valuePropName:"checked",children:Ae.jsx(K,{children:"居中显示"})})]})},defaultProps:Is},Ps=[{groupId:"textGroup",groupName:"文本显示",components:[ds,gs,Ss]},{groupId:"inputGroup",groupName:"用户输入",components:[ms,ks]},{groupId:"chooseGroup",groupName:"用户选择",components:[ls,ys]}],_s=[ls,ds,ms,gs,ys,ks,Ss];function Fs(e){return _s.find((t=>t.type===e))}const{Title:Es}=z,Vs=()=>Ae.jsx(Ae.Fragment,{children:Ps.map(((e,t)=>{const{groupId:n,groupName:r,components:l}=e;return Ae.jsxs("div",{children:[Ae.jsx(Es,{level:3,style:{fontSize:"16px",marginTop:t>0?"20px":"0"},children:r}),Ae.jsx("div",{children:l.map((e=>(e=>{const{title:t,type:n,Component:r,defaultProps:l}=e,i=Z(),a=s.useCallback((()=>{i(tt({fe_id:Je(),title:t,type:n,props:l}))}),[]);return Ae.jsx("div",{onClick:a,className:"mb-3 cursor-pointer border border-light rounded border-solid bg-light p-3 hover:border-[#d9d9d9]",children:Ae.jsx("div",{className:"pointer-events-none",children:Ae.jsx(r,{})})},n)})(e)))})]},n)}))}),Ls=()=>{const{componentList:e,selectedId:t}=Ct(),n=Z(),[r,l]=s.useState(""),i=e=>{const s=e.target.value.trim();s&&t&&n(dt({fe_id:t,title:s}))};return Ae.jsx(Ae.Fragment,{children:e.map((s=>{const{fe_id:a,title:c,isHidden:o,isLocked:d}=s,x=w({"flex-auto line-height-loose":!0,"color-blue":a===t}),u="opacity-20",m=w({[u]:o}),j=w({[u]:o});return Ae.jsxs("div",{className:"flex border-b border-b-green-200 border-b-solid py-2",children:[Ae.jsxs("div",{className:x,onClick:()=>(s=>{const r=e.find((e=>e.fe_id===s));return r&&r.isHidden?F.info("不能选中隐藏的组件!"):s!==t?(n(et(s)),void l("")):void l(s)})(a),children:[a===r&&Ae.jsx(T,{value:c,onChange:i,onPressEnter:()=>l(""),onBlur:()=>l("")}),a!==r&&c]}),Ae.jsx("div",{className:"w-12 text-end",children:Ae.jsxs(_,{children:[Ae.jsx(E,{size:"small",shape:"circle",className:m,icon:Ae.jsx(h,{}),type:o?"primary":"text",onClick:()=>((e,t)=>{n(rt({fe_id:e,isHidden:t}))})(a,!o)}),Ae.jsx(E,{size:"small",shape:"circle",className:j,icon:Ae.jsx(p,{}),type:d?"primary":"text",onClick:()=>(e=>{n(lt({fe_id:e}))})(a)})]})})]},a)}))})},qs=()=>{const e=[{key:"componentLib",label:Ae.jsxs("span",{children:[Ae.jsx(k,{}),"组件库"]}),children:Ae.jsx(Vs,{})},{key:"layers",label:Ae.jsxs("span",{children:[Ae.jsx(i,{}),"图层"]}),children:Ae.jsx(Ls,{})}];return Ae.jsx(Ae.Fragment,{children:Ae.jsx(J,{items:e,defaultActiveKey:"componentLib"})})},Rs=({loading:e})=>{const{componentList:t,selectedIs:s}=Ct(),n=Z();if(function(){const e=Z();pe(["backspace","delete"],(()=>{bt()&&e(nt())})),pe(["ctrl.c","meta.c"],(()=>{bt()&&e(it())})),pe(["ctrl.v","meta.v"],(()=>{bt()&&e(at())})),pe("uparrow",(()=>{bt()&&e(ct())})),pe("downarrow",(()=>{bt()&&e(ot())})),pe(["ctrl.z","meta.z"],(()=>{bt()&&e(ve.undo())}),{exactMatch:!0}),pe(["ctrl.shift.z","meta.shift.z"],(()=>{bt()&&e(ve.redo())}))}(),e)return Ae.jsx("div",{className:"mt-6 text-center",children:Ae.jsx(L,{})});const r=e=>{const{type:t,props:s}=e,n=Fs(t);if(null==n)return null;const{Component:r}=n;return Ae.jsx(r,{...s})};return Ae.jsx("div",{className:"min-h-[100%] overflow-hidden bg-white",children:t.map((e=>{const{fe_id:t}=e,s=w({"m-3 border border-white rounded-sm border-solid p-3 hover:border-gray-200":!0});return Ae.jsx("div",{className:s,onClick:e=>{return s=t,e.stopPropagation(),void n(et(s));var s},children:Ae.jsx("div",{className:"pointer-events-none",children:r(e)})},t)}))})},Ts=()=>Ae.jsx("div",{className:"text-center",children:"未选中组件"}),zs=()=>{const e=Z(),{selectedComponent:t}=Ct();if(null==t)return Ae.jsx(Ts,{});const{type:s,props:n}=t,r=Fs(s);if(null==r)return Ae.jsx(Ts,{});const{PropComponent:l}=r;return Ae.jsx(l,{...n,onChange:s=>{const{fe_id:n}=t;e(st({fe_id:n,newProps:s}))}})},As=()=>{const e=wt(),[t]=R.useForm(),s=Z();return Ae.jsxs(R,{layout:"vertical",initialValues:e,onValuesChange:()=>{s(Ge(t.getFieldsValue()))},form:t,children:[Ae.jsx(R.Item,{name:"title",label:"问卷标题",rules:[{required:!0,message:"请输入标题"}],children:Ae.jsx(T,{placeholder:"请输入标题"})}),Ae.jsx(R.Item,{name:"desc",label:"问卷描述",children:Ae.jsx(Y,{placeholder:"问卷描述信息"})}),Ae.jsx(R.Item,{name:"css",label:"样式代码",children:Ae.jsx(Y,{placeholder:"请输入 CSS 样式代码"})}),Ae.jsx(R.Item,{name:"js",label:"脚本代码",children:Ae.jsx(Y,{placeholder:"请输入 JS 脚本代码"})})]})},$s=()=>{const[e,t]=s.useState("prop"),{selectedId:n}=Ct();s.useEffect((()=>{t(n?"prop":"setting")}),[n]);const r=[{key:"prop",label:Ae.jsxs("span",{children:[Ae.jsx(I,{}),"属性"]}),children:Ae.jsx(zs,{})},{key:"setting",label:Ae.jsxs("span",{children:[Ae.jsx(N,{}),"页面设置"]}),children:Ae.jsx(As,{})}];return Ae.jsx(J,{activeKey:e,items:r})},Ds=()=>{const e=Z(),{loading:t}=_t(),{title:s}=wt();return fe(s?`问卷编辑 - ${s}`:"问卷调查"),Ae.jsxs("div",{className:"h-screen flex flex-col bg-[#f0f2f5]",children:[Ae.jsx(ss,{}),Ae.jsx("div",{className:"flex-1 py-3",children:Ae.jsxs("div",{className:"mx-6 h-100% flex",children:[Ae.jsx("div",{className:"w-75 bg-white px-3",children:Ae.jsx(qs,{})}),Ae.jsx("div",{className:"relative flex-1 overflow-hidden",onClick:()=>{e(et(""))},children:Ae.jsx("div",{className:"absolute left-1/2 top-1/2 h-178 w-150 transform items-center justify-center overflow-auto shadow-2xl -translate-x-1/2 -translate-y-1/2",children:Ae.jsx(Rs,{loading:t})})}),Ae.jsx("div",{className:"w-75 bg-white px-3",children:Ae.jsx($s,{})})]})})]})},Os=()=>{const{loading:e,questionData:t}=_t();return Ae.jsxs("div",{children:[Ae.jsx("p",{children:"Stat"}),e?Ae.jsx("p",{children:"loading"}):Ae.jsx("p",{children:JSON.stringify(t)})]})},{Title:Hs,Paragraph:Us}=z,Bs=()=>{const e=de();return Ae.jsx("div",{className:"h-150 flex flex-col items-center justify-center",children:Ae.jsxs("div",{className:"text-center",children:[Ae.jsx(Hs,{children:"问卷调查 | 在线投票"}),Ae.jsx(Us,{children:"已经累计创建问卷 500 份，发布问卷 80 份，收到答卷 2000 份"}),Ae.jsx("div",{className:"h-15 font-24",children:Ae.jsx(E,{className:"b-rounded-4",type:"primary",onClick:()=>e(Zs),children:"开始使用"})})]})})},{Title:Ms}=z,Ks="USERNAME",Ws="PASSWORD",Gs=()=>{const e=de(),t=Z(),[n]=R.useForm();s.useEffect((()=>{const{username:e,password:t}={username:localStorage.getItem(Ks),password:localStorage.getItem(Ws)};n.setFieldsValue({username:e,password:t})}),[]);const{run:r}=je((async(e,s)=>{const n=await async function(e,t){const s={username:e,password:t};return await vt.post("/api/user/login",s)}(e,s);return n.token&&t(Be({username:e,nickname:e})),n}),{manual:!0,onSuccess(t){const{token:s=""}=t;!function(e){localStorage.setItem(yt,e)}(s),F.success("登录成功"),e(Zs)}});return Ae.jsxs("div",{className:"flex flex-col items-center justify-center bg-white",children:[Ae.jsx("div",{children:Ae.jsxs(_,{children:[Ae.jsx(Ms,{level:2,children:Ae.jsx(o,{})}),Ae.jsx(Ms,{level:2,children:"登录"})]})}),Ae.jsx("div",{children:Ae.jsxs(R,{labelCol:{span:6},wrapperCol:{span:16},onFinish:e=>{const{username:t,password:s,remember:n}=e||{};r(t,s),n?function(e,t){localStorage.setItem(Ks,e),localStorage.setItem(Ws,t)}(t,s):(localStorage.removeItem(Ks),localStorage.removeItem(Ws))},children:[Ae.jsx(R.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{type:"string",min:5,max:20,message:"字符长度在 5-20 之间"},{pattern:/^\w+$/,message:"只能所字符下划线"}],children:Ae.jsx(T,{})}),Ae.jsx(R.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:Ae.jsx(T.Password,{})}),Ae.jsx(R.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:0,span:10},children:Ae.jsx(K,{children:"记住我"})}),Ae.jsx(R.Item,{wrapperCol:{offset:4,span:18},children:Ae.jsxs(_,{children:[Ae.jsx(E,{type:"primary",htmlType:"submit",children:"登录"}),Ae.jsx(ie,{to:Qs,children:"注册新用户"})]})})]})})]})},Js=ue([{path:"/",element:Ae.jsx(zt,{}),children:[{path:"/",element:Ae.jsx(Bs,{})},{path:"login",element:Ae.jsx(Gs,{})},{path:"register",element:Ae.jsx(Ot,{})},{path:"manage",element:Ae.jsx(At,{}),children:[{path:"list",element:Ae.jsx(Gt,{})},{path:"star",element:Ae.jsx(es,{})},{path:"trash",element:Ae.jsx(Qt,{})}]},{path:"*",element:Ae.jsx(Ht,{})}]},{path:"question",element:Ae.jsx($t,{}),children:[{path:"edit/:id",element:Ae.jsx(Ds,{})},{path:"stat/:id",element:Ae.jsx(Os,{})}]}],{basename:"/survey-sage"}),Ys="/",Xs="/login",Qs="/register",Zs="/manage/list",en=()=>Ae.jsx(X,{theme:{algorithm:Q.defaultAlgorithm},children:Ae.jsx(me,{router:Js})});$e.createRoot(document.getElementById("root")).render(Ae.jsx(S.StrictMode,{children:Ae.jsx(te,{store:mt,children:Ae.jsx(en,{})})}))}}}));
